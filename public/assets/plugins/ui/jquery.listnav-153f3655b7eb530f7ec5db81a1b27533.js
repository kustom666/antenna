/*
*
* jQuery listnav plugin
* Copyright (c) 2009 iHwy, Inc.
* Author: Jack Killpatrick
*
* Version 2.1 (08/09/2009)
* Requires jQuery 1.3.2, jquery 1.2.6 or jquery 1.2.x plus the jquery dimensions plugin
*
* Visit http://www.ihwy.com/labs/jquery-listnav-plugin.aspx for more information.
*
* Dual licensed under the MIT and GPL licenses:
*   http://www.opensource.org/licenses/mit-license.php
*   http://www.gnu.org/licenses/gpl.html
*
*/
(function(e){e.fn.listnav=function(l){var n=e.extend({},e.fn.listnav.defaults,l),t=["_","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","-"],i=!1;return n.prefixes=e.map(n.prefixes,function(e){return e.toLowerCase()}),this.each(function(){function l(){if(f.append(d()),p=e(".ln-letters",f).slice(0,1),n.showCounts&&(m=e(".ln-letter-count",f).slice(0,1)),o(),r(),n.flagDisabled&&c(),u(),n.includeAll||v.show(),n.includeAll||e(".all",p).remove(),n.includeNums||e("._",p).remove(),n.includeOther||e(".-",p).remove(),e(":last",p).addClass("ln-last"),e.cookie&&null!=n.cookieName){var l=e.cookie(n.cookieName);null!=l&&(n.initLetter=l)}if(""!=n.initLetter)i=!0,e("."+n.initLetter.toLowerCase(),p).slice(0,1).click();else if(n.includeAll)e(".all",p).addClass("ln-selected");else for(var s=n.includeNums?0:1;t.length>s;s++)if(k[t[s]]>0){i=!0,e("."+t[s],p).slice(0,1).click();break}}function s(){m.css({top:e(".a",p).slice(0,1).offset({margin:!1,border:!0}).top-m.outerHeight({margin:!0})})}function o(){var l,t,i,s,o=n.prefixes.length>0;e(v).children().each(function(){s=e(this),t="",l=e.trim(s.text()).toLowerCase(),""!=l&&(o&&(i=l.split(" "),i.length>1&&e.inArray(i[0],n.prefixes)>-1&&(t=i[1].charAt(0),a(t,s,!0))),t=l.charAt(0),a(t,s))})}function a(e,l,n){/\W/.test(e)&&(e="-"),isNaN(e)||(e="_"),l.addClass("ln-"+e),void 0==k[e]&&(k[e]=0),k[e]++,n||w++}function c(){for(var l=0;t.length>l;l++)void 0==k[t[l]]&&e("."+t[l],p).addClass("ln-disabled")}function r(){v.append('<li class="ln-no-match" style="display:none">'+n.noMatchText+"</li>")}function h(l){if(e(l).hasClass("all"))return w;var n=k[e(l).attr("class").split(" ")[0]];return void 0!=n?n:0}function u(){n.showCounts&&f.mouseover(function(){s()}),n.showCounts&&(e("a",p).mouseover(function(){var l=e(this).position().left,n=e(this).outerWidth({margin:!0})-1+"px",t=h(this);m.css({left:l,width:n}).text(t).show()}),e("a",p).mouseout(function(){m.hide()})),e("a",p).click(function(){e("a.ln-selected",p).removeClass("ln-selected");var l=e(this).attr("class").split(" ")[0];if("all"==l)v.children().show(),v.children(".ln-no-match").hide(),g=!0;else{g?(v.children().hide(),g=!1):""!=x&&v.children(".ln-"+x).hide();var t=h(this);t>0?(v.children(".ln-no-match").hide(),v.children(".ln-"+l).show()):v.children(".ln-no-match").show(),x=l}return e.cookie&&null!=n.cookieName&&e.cookie(n.cookieName,l),e(this).addClass("ln-selected"),e(this).blur(),i||null==n.onClick?i=!1:n.onClick(l),!1})}function d(){for(var e=[],l=1;t.length>l;l++)0==e.length&&e.push('<a class="all" href="#">ALL</a><a class="_" href="#">0-9</a>'),e.push('<a class="'+t[l]+'" href="#">'+("-"==t[l]?"...":t[l].toUpperCase())+"</a>");return'<div class="ln-letters">'+e.join("")+"</div>"+(n.showCounts?'<div class="ln-letter-count" style="display:none; position:absolute; top:0; left:0; width:20px;">0</div>':"")}var f,v,p,m,C;C=this.id,f=e("#"+C+"-nav"),v=e(this);var k={},w=0,g=!0,x="";l()})},e.fn.listnav.defaults={initLetter:"",includeAll:!0,incudeOther:!1,includeNums:!0,flagDisabled:!0,noMatchText:"No matching entries",showCounts:!0,cookieName:null,onClick:null,prefixes:[]}})(jQuery);